<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤ IT</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .animate-fadeIn {
      animation: fadeIn 0.5s ease-out;
    }

    .animate-slideIn {
      animation: slideIn 0.4s ease-out;
    }



    .card-shadow {
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body class=" from-blue-50 to-indigo-100 min-h-screen overflow-x-hidden">

  <div class="container mx-auto px-4 py-8 max-w-5xl">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 space-y-6 md:space-y-0">

      <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤ -->
      <div class="bg-white rounded-2xl p-6 card-shadow animate-slideIn">
        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-gray-200">
          <div class="w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center">
            <span class="text-2xl">üìù</span>
          </div>
          <h2 class="text-xl font-bold text-gray-800">‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏´‡∏°‡πà</h2>
        </div>

        <div class="space-y-4">
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              <span class="text-red-500">*</span> ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á
            </label>
            <input id="name" type="text" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"
              class="w-full px-4 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" />
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              <span class="text-red-500">*</span> ‡πÅ‡∏ú‡∏ô‡∏Å
            </label>
            <select id="dept"
              class="w-full px-4 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å --</option>
              <option>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</option>
              <option>‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
              <option>‡∏Ç‡∏≤‡∏¢</option>
              <option>‡∏ú‡∏•‡∏¥‡∏ï</option>
              <option>HR</option>
              <option>IT</option>
            </select>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              <span class="text-red-500">*</span> ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå/‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
            </label>
            <select id="device"
              class="w-full px-4 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
              <option>Printer</option>
              <option>Network/Internet</option>
              <option>PC/Notebook</option>
              <option>NAS/Synology</option>
              <option>Camera/CCTV</option>
              <option>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</option>
              <option>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≤‡∏¢</option>
            </select>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              <span class="text-red-500">*</span> ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤
            </label>
            <textarea id="issue" rows="4" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡πÇ‡∏î‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î..."
              class="w-full px-4 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition resize-none"></textarea>
          </div>

          <button onclick="submitForm()"
            class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold py-3.5 rounded-lg shadow-lg hover:shadow-xl hover:from-indigo-700 hover:to-purple-700 transition-all transform hover:scale-[1.02] active:scale-95">
            <span class="flex items-center justify-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
              </svg>
              ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤
            </span>
          </button>

          <div id="formMsg" class="text-sm text-center min-h-[24px]"></div>
        </div>
      </div>

      <!-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
      <div class="bg-white rounded-2xl p-6 card-shadow animate-slideIn" style="animation-delay: 0.1s;">
        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-gray-200">
          <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
            <span class="text-2xl">üîç</span>
          </div>
          <h2 class="text-xl font-bold text-gray-800">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h2>
        </div>

        <div class="space-y-4">
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á
            </label>
            <div class="flex flex-col md:flex-row gap-2">
              <input id="searchQuery" type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤"
                class="flex-1 px-4 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-green-500 focus:border-transparent transition"
                onkeypress="if(event.key==='Enter') searchStatus()" />
              <button onclick="searchStatus()"
                class="px-6 py-2.5 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition shadow hover:shadow-lg">
                ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
              </button>
            </div>
          </div>

          <div id="statusResult" class="space-y-3 max-h-96 overflow-y-auto">
            <div class="text-center text-gray-400 py-8">
              <svg class="w-16 h-16 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor"
                viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
              <p class="text-sm">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ -->
    <div class="mt-6 bg-white rounded-2xl p-6 card-shadow animate-fadeIn" style="animation-delay: 0.2s;">
      <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2">
        <span class="text-xl">üí°</span> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
      </h3>
      <ul class="text-sm text-gray-600 space-y-2">
        <li class="flex items-start gap-2">
          <span class="text-indigo-600 font-bold">‚Ä¢</span>
          <span>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏° IT ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-indigo-600 font-bold">‚Ä¢</span>
          <span>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á (‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</span>
        </li>
        <li class="flex items-start gap-2">
          <span class="text-indigo-600 font-bold">‚Ä¢</span>
          <span>‡∏ó‡∏µ‡∏° IT ‡∏à‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£)</span>
        </li>
      </ul>
    </div>
  </div>

  <script>
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
    function submitForm() {
      const fields = ['name', 'dept', 'device', 'issue'];
      const msgBox = document.getElementById('formMsg');

      const payload = {};
      let hasEmpty = false;
      fields.forEach(id => {
        const val = document.getElementById(id).value.trim();
        payload[id] = val;
        if (!val) hasEmpty = true;
      });

      if (hasEmpty) {
        msgBox.innerHTML = '<span class="text-red-600 font-medium flex items-center justify-center gap-1"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/></svg> ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á</span>';
        return;
      }

      fields.forEach(id => document.getElementById(id).disabled = true);

      msgBox.innerHTML = '<span class="text-blue-600 font-medium animate-pulse flex items-center justify-center gap-2"><svg class="animate-spin h-4 w-4" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>';

      google.script.run
        .withSuccessHandler(res => {
          if (res.ok) {
            msgBox.innerHTML = `<div class="bg-green-50 border border-green-200 rounded-lg p-3 text-green-800"><div class="flex items-center gap-2 font-medium"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg> ‡∏™‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</div><div class="text-sm mt-1">‡∏£‡∏´‡∏±‡∏™ Ticket: <span class="font-bold">${res.ticketId}</span></div></div>`;
            fields.forEach(id => document.getElementById(id).value = '');
          } else {
            msgBox.innerHTML = '<span class="text-red-600 font-medium flex items-center justify-center gap-1">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</span>';
          }
          fields.forEach(id => document.getElementById(id).disabled = false);
        })
        .withFailureHandler(err => {
          msgBox.innerHTML = '<span class="text-red-600 font-medium text-xs">‚ùå ‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + err.message + '</span>';
          fields.forEach(id => document.getElementById(id).disabled = false);
        })
        .submitIssue(payload);
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
    function searchStatus() {
      const query = document.getElementById('searchQuery').value.trim();
      const resultBox = document.getElementById('statusResult');

      if (!query) {
        resultBox.innerHTML = '<div class="text-center text-gray-400 py-8"><svg class="w-16 h-16 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg><p class="text-sm">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</p></div>';
        return;
      }

      resultBox.innerHTML = '<div class="text-center text-gray-400 py-8 animate-pulse"><svg class="animate-spin h-8 w-8 mx-auto mb-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><p class="text-sm">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...</p></div>';

      google.script.run
        .withSuccessHandler(res => {
          if (res.ok && res.items.length > 0) {
            const html = res.items.map(item => {
              const statusColor = item.status === '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' ? 'bg-green-100 text-green-800' :
                item.status === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' ? 'bg-blue-100 text-blue-800' :
                  item.status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' ? 'bg-yellow-100 text-yellow-800' :
                    item.status === '‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß' ? 'bg-purple-100 text-purple-800' :
                      'bg-gray-100 text-gray-800';

              const regex = new RegExp(`(${query})`, 'gi');
              const nameHighlighted = item.name.replace(regex, '<span class="bg-yellow-200">$1</span>');
              const issueHighlighted = item.issue.replace(regex, '<span class="bg-yellow-200">$1</span>');

              return `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition">
                  <div class="flex items-start justify-between mb-2">
                    <div>
                      <div class="font-bold text-gray-800">${item.ticketId}</div>
                      <div class="text-sm text-gray-600">${nameHighlighted}</div>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs font-semibold ${statusColor}">${item.status}</span>
                  </div>
                  <div class="text-sm text-gray-600 space-y-1">${issueHighlighted}</div>
                  <div class="text-xs text-gray-400 mt-2">${item.date}</div>
                </div>`;
            }).join('');
            resultBox.innerHTML = html;
          } else {
            resultBox.innerHTML = '<div class="text-center text-gray-400 py-8">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
          }
        })
        .withFailureHandler(err => {
          resultBox.innerHTML = `<div class="text-center text-red-600 py-8">‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${err.message}</div>`;
        })
        .searchTickets(query);
    }
  </script>

</body>

</html>
